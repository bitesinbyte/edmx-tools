@page "/"

<PageTitle>Home</PageTitle>

@inject NotificationService NotificationService

<RadzenStack AlignItems="AlignItems.Center" Class="rz-mx-auto rz-my-12">
    <RadzenImage Path="favicons/android-chrome-512x512.png" Style="width: 15rem;" AlternateText="Bites In Byte" />
    <RadzenText TextStyle="TextStyle.H4" Text="Bites In Byte - Edmx Tools" />
    <RadzenText TextStyle="TextStyle.Body1">
        Effortlessly Convert <strong>EDMX</strong> to <strong>OpenAPI</strong> or <strong>Trim</strong> the Edmx
        File
    </RadzenText>
</RadzenStack>
<RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.Center" Gap="0.5rem"
    Class="rz-pt-4 rz-pb-8">
    <RadzenCard class="my-4">
        <RadzenText TextStyle="TextStyle.H6" Text="Upload Edmx File" />
        <InputFile OnChange="@SingleUpload" />
    </RadzenCard>
</RadzenStack>


<RadzenCard hidden=@isTabHidden>
    <RadzenTabs RenderMode="TabRenderMode.Client">
        <Tabs>
            <RadzenTabsItem Text="Explore">
                <EdmxExplorer XmlData=@xmlData />
            </RadzenTabsItem>
            <RadzenTabsItem Text="Trim">
                <EdmxTrim XmlData=@xmlData />
            </RadzenTabsItem>
        </Tabs>
    </RadzenTabs>

</RadzenCard>

@code {

    bool isTabHidden = true;
    private string xmlData = string.Empty;
    private string fileName = string.Empty;

    private async Task SingleUpload(InputFileChangeEventArgs e)
    {
        var ms = new MemoryStream();
        await e.File.OpenReadStream().CopyToAsync(ms);
        var byteArray = ms.ToArray();
        xmlData = System.Text.Encoding.Default.GetString(byteArray);
        isTabHidden = false;
        NotificationService.Notify(NotificationSeverity.Success, $"Upload {fileName} Successful", "Upload Successful");
        await InvokeAsync(StateHasChanged);
    }
}